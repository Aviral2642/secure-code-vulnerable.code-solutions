
<!DOCTYPE html>
<html>
<head>
  <title>CVE-2019-14192 - u-boot NFS</title>
  <meta charset="UTF-8">
</head>
<body>
  <h2>Challenge: CVE-2019-14192 - u-boot NFS</h2>
  <p><strong>Question:</strong> Is this an integer overflow or underflow?</p>

  <input type="text" id="userAnswer" placeholder="Enter your answer">
  <button onclick="checkAnswer()">Submit</button>

  <div id="solution" style="display:none; margin-top:20px;">
    <h3>✅ Correct!</h3>
    <h4>Challenge Description:</h4>
    <p>The Universal Bootloader (u-boot) is used primarily on embedded systems to load a full OS like Linux. u-boot supports fetching the OS from the network via the Network File System (NFS) protocol (which runs on top of UDP/IP).</p>

    <h4>Code Snippet (Partial):</h4>
    <pre>
ip = (struct ip_udp_hdr *)(in_packet + E802_HDR_SIZE);
// ...
if (len < ntohs(ip->ip_len)) {
    debug("len bad %d < %d\n", len, ntohs(ip->ip_len));
    return;
}
len = ntohs(ip->ip_len);
// ...
(*udp_packet_handler)((uchar *)ip + IP_UDP_HDR_SIZE,
    ntohs(ip->udp_dst),
    src_ip,
    ntohs(ip->udp_src),
    ntohs(ip->udp_len) - UDP_HDR_SIZE);
    </pre>

    <h4>Answers:</h4>
    <ul>
      <li><b>Which pointer is causing the vulnerability?</b> <code>ip->udp_len</code></li>
      <li><b>What is the line where the vulnerability happens?</b> <code>47</code></li>
      <li><b>Type of vulnerability:</b> <code>underflow</code></li>
    </ul>

    <h4>Explanation:</h4>
    <p>The vulnerability lies in the unchecked use of <code>ip->udp_len</code>. If this value is smaller than <code>UDP_HDR_SIZE</code>, subtracting it results in an integer underflow, leading to incorrect memory access or overflow of buffer bounds.</p>
  </div>

  <script>
    function checkAnswer() {
      const correctAnswer = "underflow";
      const userInput = document.getElementById("userAnswer").value.trim().toLowerCase();

      if (userInput === correctAnswer) {
        document.getElementById("solution").style.display = "block";
      } else {
        alert("❌ Incorrect. Try again!");
      }
    }
  </script>
</body>
</html>
